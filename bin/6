#!/usr/bin/env perl6

use lib $*PROGRAM.sibling: '../lib';
use JSON::Fast;
my $conf := from-json slurp $*PROGRAM.sibling: '../config.json';

use RDev;

my $rd := RDev.new: :$conf;

multi MAIN(Bool :$test) {
    $rd.re-make-rakudo: :$test;
}

multi MAIN('n', Bool :$test) {
    $rd.re-make-nqp:    :$test;
    $rd.re-make-rakudo: :$test, :clean;
}

multi MAIN('m') {
    $rd.re-make-moar;
}

multi MAIN(Bool:D :$init!) {
    $rd.init;
    $rd.build-moar;
    $rd.build-nqp:   :test;
    $rd.build-rakudo :test;
    $rd.make-links;
}

multi MAIN(:$links!) { $rd.make-links; }
